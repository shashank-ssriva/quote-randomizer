dist: trusty
sudo: required

addons:
  sonarcloud:
    organization: "shashank-ssriva-github"
    token:
      secure: "d23DB+6kowklkqlLx52TItk5P/suy+LOu5osuc53753fezJFtjTVdY1cu+phnOmW8p0ggQ5YyYYMn9Rh7Kkqc1Y+0HFr5tdbFrj0GoeZgBHafG2wfpemGG3LMBSwr6+iEZAyWAXEIH36AZM26R1fSn21G5W3rk24h18BbfTTcKjkVpO68KG1IUV3rFxvuyIJ8a8g2KcWPLhiLKRRUdpYBleZxjSzfrBbpt/6bHihs3HqVBHpj51FHn2PZKprz1hju+5X++zq3Q740rvF+WSaSxBjzWbfX9LKdAArz47i7gt9YEmaaxjSsEOtvIyMQzfyn9tIfU7mSTGbCnyopn5MPoruO91EXdgVafXxip3GWBqp2ODHeauKzaaOwbb8DD05OobfGNNGkmbRiBEChpZEia6BsYEyI1na/dPPoDn6dWQ0nriq9im6NuuDTXOpGVB6bvo8yo+/SxKOovleNdVbdowuampZSuyWPpIQIh0DmKqExAd9luKvWHnEaqm3OQJM9lQ8Xq3uYgXImLXOyjDJLhaTQXPY8bzeIdQNzKzN80PdNnMti6qwn2MPThsXfNgJDwMJGjAe94g7tCgWI6dN+oQT5g57zYOBLS2eJlu1nPFhXoM3H05je466DvLElMNVHSppEU22dB++hHytJj5q/C4VsJrZso5TI4ZIvyIHOtg="

services:
  - docker

language: python

script:
  # simple test
  - python3 -m pytest -v

  # code coverage test  
  - coverage report -m app.py

  # sonar scanner
  - sonar-scanner


after_success:
  - sh .deploy_scripts/deploy_dockerhub.sh
    test "$TRAVIS_BRANCH" = "master" && sh .deploy_scripts/deploy_heroku.sh
